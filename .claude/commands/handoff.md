---
name: handoff
description: Написать или обновить документ передачи контекста для следующего агента.
---

Напиши или обнови документ передачи контекста, чтобы следующий агент с чистым контекстом мог продолжить работу.

## Шаг 0: Определи, куда писать

Есть два варианта:

### Вариант A: `HANDOFF.md` в корне проекта
Используй, когда:
- Работа идёт над проектом в целом (одна задача, нет иерархии)
- Нет отдельной папки/контекста для конкретной задачи
- Задача одна и она "про весь проект"

### Вариант B: `status.md` в папке задачи
Используй, когда:
- В проекте несколько параллельных задач, каждая со своей папкой или контекстом
- Работа ведётся над конкретной задачей внутри иерархии (например, `tasks/aia-765/`, `features/billing/`, `docs/migration/`, `proposals/auth/`)
- У задачи уже есть своя папка с документацией

В этом случае пиши в `status.md` внутри папки задачи (например, `tasks/aia-765/status.md`), а **не** в HANDOFF.md на уровне проекта. Это позволяет каждой задаче иметь свой независимый контекст передачи.

**Как определить:** посмотри, над чем мы работали в этом чате. Если работа была сфокусирована на конкретной папке/задаче и в проекте есть (или подразумевается) несколько таких задач — выбирай Вариант B. Если сомневаешься — спроси пользователя.

---

## Шаги

1. Определи целевой файл (Вариант A или B, см. выше)
2. Проверь, существует ли этот файл
3. Если существует — сначала прочитай его, чтобы понять предыдущий контекст
4. Определи, есть ли в проекте сопровождающие документы, над которыми мы работали в этом чате (спецификации, ТЗ, описания и т.д.)
5. Создай или обнови документ со следующими разделами:

   - **Цель**: Что мы пытаемся сделать
   - **Рабочие файлы**: Список файлов, над которыми велась работа в этом чате. Если основной контекст зафиксирован в самих файлах (спецификация, ТЗ и т.д.) — НЕ дублируй их содержимое. Достаточно указать путь к файлу и кратко — что именно в нём делалось/менялось.
   - **Текущий прогресс**: Что сделано на данный момент
   - **Что сработало**: Подходы, которые оказались успешными
   - **Что не сработало**: Подходы, которые провалились (чтобы их не повторяли)
   - **Важные детали и заметки**: Кастомные детали, которые легко потерять при смене контекста. Примеры: доступы и ограничения окружения ("доступ к куберу только в кластер home-n1"), рабочие команды и сниппеты ("деплой через `make deploy-staging`"), особенности инфраструктуры, нюансы конфигурации, любые ad-hoc замечания пользователя, которые не зафиксированы в основных документах.
   - **Следующие шаги**: Чёткие action items для продолжения работы

## Важно

- Не раздувай документ — он должен быть компактным и полезным
- Если контекст уже зафиксирован в рабочих файлах, ссылайся на них, а не копируй содержимое
- Для Варианта B: если в папке задачи уже есть `status.md` с другой структурой — адаптируйся к ней, не ломай существующий формат

Сохрани файл и сообщи пользователю путь к нему, чтобы он мог начать новый чат с этим файлом.